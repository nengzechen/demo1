# ===========================================
# Play Framework 应用配置文件
# ===========================================

# 应用名称
play.application.name = "play-demo"

# 启用Ebean模块
ebean.default = ["models.*"]

# 密钥配置（生产环境请修改）
play.http.secret.key = "changeme-this-is-a-secret-key-for-development-only"

# 允许的主机
play.filters.hosts {
  allowed = ["localhost", "127.0.0.1", "localhost:9000", "127.0.0.1:9000"]
}

# 禁用 CSRF 过滤器（方便 Postman 测试）
play.filters.disabled += "play.filters.csrf.CSRFFilter"

# 启用 CORS（跨域支持）
play.filters.enabled += "play.filters.cors.CORSFilter"

play.filters.cors {
  allowedOrigins = ["*"]
  allowedHttpMethods = ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
  allowedHttpHeaders = ["Accept", "Content-Type", "Origin"]
}

# HTTP 配置
play.http {
  # Session 配置
  session {
    maxAge = 1h
    secure = false
  }

  # 错误处理
  errorHandler = "controllers.ErrorHandler"

  # 全局过滤器配置
  filters = "filters.Filters"
}

# 国际化配置
play.i18n {
  langs = ["zh-CN", "en"]
}

# JSON 配置
play.http.parser.maxMemoryBuffer = 10MB

# 数据库配置（MySQL）
db.default {
  driver = "com.mysql.cj.jdbc.Driver"
  url = "jdbc:mysql://localhost:3062/play_demo?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Shanghai&useSSL=false&allowPublicKeyRetrieval=true"
  username = "root"
  password = "CLlove123"

  # 连接池配置
  hikaricp {
    maximumPoolSize = 10
    minimumIdle = 5
    connectionTimeout = 30000
    idleTimeout = 600000
    maxLifetime = 1800000
  }
}

# Ebean 配置
ebean.default = ["models.*"]

# 日志级别
logger.root = INFO
logger.play = INFO
logger.application = DEBUG

# ===========================================
# Akka Actor System 配置
# ===========================================
akka {
  loggers = ["akka.event.slf4j.Slf4jLogger"]
  loglevel = "INFO"
  logging-filter = "akka.event.slf4j.Slf4jLoggingFilter"

  actor {
    provider = "cluster"

    # 序列化配置
    serialization-bindings {
      "actors.TaskMessage" = jackson-json
    }

    # Actor默认调度器
    default-dispatcher {
      type = Dispatcher
      executor = "fork-join-executor"
      fork-join-executor {
        parallelism-min = 2
        parallelism-factor = 2.0
        parallelism-max = 10
      }
      throughput = 100
    }
  }

  # Akka Cluster 配置
  cluster {
    # 种子节点列表
    seed-nodes = [
      "akka://application@127.0.0.1:2551",
      "akka://application@127.0.0.1:2552"
    ]

    # 关闭自动down功能
    auto-down-unreachable-after = off

    # 集群角色
    roles = ["worker"]

    # 最小节点数
    min-nr-of-members = 1
  }

  # Remote 配置
  remote {
    artery {
      enabled = on
      transport = tcp
      canonical.hostname = "127.0.0.1"
      canonical.port = 2551
    }
  }

  # Akka Management
  management {
    http {
      hostname = "127.0.0.1"
      port = 8558
    }
  }
}

